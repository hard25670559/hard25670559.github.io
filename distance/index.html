<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <div>
	    <input id="origins_a" type="text">
	    <input id="origins_b" type="text">	
    </div>

    <div>
    	<input id="destinations_a" type="text">
    	<input id="destinations_b" type="text">
    </div>

    <div>
    	<input type="button" value="查詢" id="search">
    </div>
    
	<p id="origin_addresses"></p>
	<p id="destination_addresses"></p>
	<p id="distance"></p>
	<p id="duration"></p>
	

	<input type="button" value="一筆一筆查ㄅ" onclick="setResult()">

	<script>

		$('#search').on('click', function(event) {
			getDistance();
		});

		var result = [];

		function getDistance2(a, b, c, d) {

			$.ajax({
				url: 'https://maps.googleapis.com/maps/api/distancematrix/json?mode=driving&origins=' + 
					a + ',' + b + '&destinations=' + c + ',' + d + '&key=AIzaSyBjhFib1SV0nsoB_uYHlqKe-R5_goyjTn0',
				type: 'get',
				dataType: 'json',
			})
			.done(function(data) {
				console.log(data.origin_addresses[0]);
				console.log(data.destination_addresses[0]);
				console.log(data.rows[0].elements[0].distance.text);
				console.log(data.rows[0].elements[0].duration.text);

				result.push({
					"origin_addresses" : data.origin_addresses[0],
					"destination_addresses" : data.destination_addresses[0],
					"distance" : data.rows[0].elements[0].distance.text,
					"duration" : data.rows[0].elements[0].duration.text,
				});

			})
			.fail(function() {
				console.log("error");
			})
			.always(function() {
				console.log("-------------------");
			});
		}

		function getDistance() {
			$.ajax({
				url: 'https://maps.googleapis.com/maps/api/distancematrix/json?mode=driving&origins=' + $('#origins_a').val() + ',' + $('#origins_b').val() + '&destinations=' + $('#destinations_a').val() + ',' + $('#destinations_b').val() + '&key=AIzaSyBjhFib1SV0nsoB_uYHlqKe-R5_goyjTn0',
				type: 'get',
				dataType: 'json',
			})
			.done(function(data) {
				$('#origin_addresses').empty();
				$('#destination_addresses').empty();
				$('#distance').empty();
				$('#duration').empty();

				$('#origin_addresses').text('起始：' + data.origin_addresses);
				$('#destination_addresses').text('終點：' + data.destination_addresses);
				$('#distance').text('兩點距離：' + data.rows[0].elements[0].distance.text);
				$('#duration').text('行駛時間：' + data.rows[0].elements[0].duration.text);

			})
			.fail(function() {
				console.log("error");
			})
			.always(function() {
				console.log("complete");
			});
		}

		var test = [
			{ "x" : 24.146142, "y" : 120.733571 },
			{ "x" : 24.145465, "y" : 120.734374 },
			{ "x" : 24.145089, "y" : 120.734404 },
			{ "x" : 24.144799, "y" : 120.734426 },
			{ "x" : 24.144519, "y" : 120.734420 },
			{ "x" : 24.144334, "y" : 120.734386 },
			{ "x" : 24.144110, "y" : 120.734289 },
			{ "x" : 24.143904, "y" : 120.734174 },
			{ "x" : 24.143307, "y" : 120.733729 },
			{ "x" : 24.142566, "y" : 120.733251 },
			{ "x" : 24.142014, "y" : 120.732959 },
			{ "x" : 24.141935, "y" : 120.732891 },
			{ "x" : 24.141723, "y" : 120.732742 },
			{ "x" : 24.141563, "y" : 120.732641 },
			{ "x" : 24.141217, "y" : 120.732396 },
			{ "x" : 24.140940, "y" : 120.732164 },
			{ "x" : 24.140711, "y" : 120.731981 },
			{ "x" : 24.140252, "y" : 120.731450 },
			{ "x" : 24.140238, "y" : 120.731013 },
			{ "x" : 24.140407, "y" : 120.729514 },
			{ "x" : 24.140984, "y" : 120.728822 },
			{ "x" : 24.141196, "y" : 120.728538 },
			{ "x" : 24.141324, "y" : 120.728242 },
			{ "x" : 24.141438, "y" : 120.727687 },
			{ "x" : 24.141545, "y" : 120.726937 },
			{ "x" : 24.141827, "y" : 120.725356 },
			{ "x" : 24.141961, "y" : 120.724606 },
			{ "x" : 24.141115, "y" : 120.723876 },
			{ "x" : 24.142264, "y" : 120.723059 },
			{ "x" : 24.142377, "y" : 120.722447 },
			{ "x" : 24.142604, "y" : 120.721474 },
			{ "x" : 24.142764, "y" : 120.721241 },
			{ "x" : 24.142668, "y" : 120.720469 },
			{ "x" : 24.142639, "y" : 120.720396 },
			{ "x" : 24.142319, "y" : 120.718922 },
			{ "x" : 24.142165, "y" : 120.718013 },
			{ "x" : 24.142092, "y" : 120.717726 },
			{ "x" : 24.141919, "y" : 120.716868 },
			{ "x" : 24.141896, "y" : 120.716711 },
			{ "x" : 24.141858, "y" : 120.716424 },
			{ "x" : 24.141834, "y" : 120.716341 },
			{ "x" : 24.141770, "y" : 120.715981 },
			{ "x" : 24.141648, "y" : 120.715550 },
			{ "x" : 24.141546, "y" : 120.715050 },
			{ "x" : 24.141459, "y" : 120.714597 },
			{ "x" : 24.141367, "y" : 120.713955 },
			{ "x" : 24.141291, "y" : 120.713384 },
			{ "x" : 24.141280, "y" : 120.713286 },
			{ "x" : 24.141169, "y" : 120.712756 },
			{ "x" : 24.141087, "y" : 120.712249 },
			{ "x" : 24.141029, "y" : 120.711719 },
			{ "x" : 24.140968, "y" : 120.711445 },
			{ "x" : 24.140919, "y" : 120.710957 },
			{ "x" : 24.140846, "y" : 120.710303 },
			{ "x" : 24.140738, "y" : 120.709273 },
			{ "x" : 24.140628, "y" : 120.708054 },
			{ "x" : 24.140511, "y" : 120.706641 },
			{ "x" : 24.140492, "y" : 120.705875 },
			{ "x" : 24.140439, "y" : 120.704300 },
			{ "x" : 24.140387, "y" : 120.703611 },
			{ "x" : 24.140301, "y" : 120.702377 },
			{ "x" : 24.140205, "y" : 120.701389 },
			{ "x" : 24.140085, "y" : 120.700035 },
			{ "x" : 24.140149, "y" : 120.699587 },
			{ "x" : 24.140208, "y" : 120.699126 },
			{ "x" : 24.140223, "y" : 120.698639 },
			{ "x" : 24.140223, "y" : 120.698272 },
			{ "x" : 24.140299, "y" : 120.697887 },
			{ "x" : 24.140290, "y" : 120.697663 },
			{ "x" : 24.140267, "y" : 120.697453 },
			{ "x" : 24.140272, "y" : 120.697105 },
			{ "x" : 24.140256, "y" : 120.696695 },
			{ "x" : 24.140282, "y" : 120.696510 },
			{ "x" : 24.140518, "y" : 120.696124 },
			{ "x" : 24.140471, "y" : 120.695467 },
			{ "x" : 24.140466, "y" : 120.694899 },
			{ "x" : 24.140442, "y" : 120.694648 },
			{ "x" : 24.140340, "y" : 120.694507 },
			{ "x" : 24.140084, "y" : 120.694029 },
			{ "x" : 24.139346, "y" : 120.692300 },
			{ "x" : 24.138760, "y" : 120.691019 },
			{ "x" : 24.138717, "y" : 120.690774 },
			{ "x" : 24.137797, "y" : 120.689976 },
			{ "x" : 24.137107, "y" : 120.689262 },
			{ "x" : 24.136962, "y" : 120.689055 },
			{ "x" : 24.136722, "y" : 120.688499 },
			{ "x" : 24.136466, "y" : 120.687829 },
			{ "x" : 24.136027, "y" : 120.686813 },
			{ "x" : 24.135608, "y" : 120.685869 },
			{ "x" : 24.135211, "y" : 120.684821 },
			{ "x" : 24.135002, "y" : 120.684404 },
			{ "x" : 24.134815, "y" : 120.683791 },
			{ "x" : 24.134629, "y" : 120.683351 },
			{ "x" : 24.134419, "y" : 120.682837 },
			{ "x" : 24.134332, "y" : 120.682677 },
			{ "x" : 24.134250, "y" : 120.682492 },
			{ "x" : 24.134151, "y" : 120.682230 },
			{ "x" : 24.133965, "y" : 120.681838 },
			{ "x" : 24.133760, "y" : 120.681314 },
			{ "x" : 24.133722, "y" : 120.681225 },
			{ "x" : 24.133530, "y" : 120.680788 },
			{ "x" : 24.133056, "y" : 120.679669 },
			{ "x" : 24.132890, "y" : 120.679264 },
			{ "x" : 24.132803, "y" : 120.679073 },
			{ "x" : 24.132643, "y" : 120.678652 },
			{ "x" : 24.132389, "y" : 120.678127 },
			{ "x" : 24.132199, "y" : 120.677623 },
			{ "x" : 24.131811, "y" : 120.676779 },
			{ "x" : 24.131511, "y" : 120.676020 },
			{ "x" : 24.131293, "y" : 120.675444 },
			{ "x" : 24.131115, "y" : 120.674966 },
			{ "x" : 24.130942, "y" : 120.674476 },
			{ "x" : 24.130477, "y" : 120.673269 },
			{ "x" : 24.130145, "y" : 120.672531 },
			{ "x" : 24.129851, "y" : 120.671849 },
			{ "x" : 24.129382, "y" : 120.670703 },
			{ "x" : 24.129194, "y" : 120.670285 },
			{ "x" : 24.128691, "y" : 120.668995 },
			{ "x" : 24.129543, "y" : 120.668543 },
			{ "x" : 24.129939, "y" : 120.668337 },
			{ "x" : 24.131115, "y" : 120.667771 },
			{ "x" : 24.131764, "y" : 120.667447 },
			{ "x" : 24.132160, "y" : 120.667218 },
			{ "x" : 24.132160, "y" : 120.667030 },
			{ "x" : 24.132161, "y" : 120.666704 },
			{ "x" : 24.132167, "y" : 120.666427 },
			{ "x" : 24.132170, "y" : 120.666302 },
			{ "x" : 24.132148, "y" : 120.665560 },
			{ "x" : 24.132134, "y" : 120.665027 },
			{ "x" : 24.132144, "y" : 120.664462 },
			{ "x" : 24.132149, "y" : 120.663660 },
			{ "x" : 24.132149, "y" : 120.663257 },
			{ "x" : 24.132146, "y" : 120.662523 },
			{ "x" : 24.132160, "y" : 120.661643 },
			{ "x" : 24.132628, "y" : 120.660779 },
			{ "x" : 24.133412, "y" : 120.659319 },
			{ "x" : 24.133487, "y" : 120.659106 },
			{ "x" : 24.133819, "y" : 120.657330 },
			{ "x" : 24.133907, "y" : 120.657190 },
			{ "x" : 24.134248, "y" : 120.656530 },
			{ "x" : 24.134376, "y" : 120.656289 },
			{ "x" : 24.134465, "y" : 120.656169 },
			{ "x" : 24.134735, "y" : 120.655693 },
			{ "x" : 24.134889, "y" : 120.655458 },
			{ "x" : 24.134946, "y" : 120.655333 },
			{ "x" : 24.135012, "y" : 120.655100 },
			{ "x" : 24.134953, "y" : 120.654499 },
			{ "x" : 24.134956, "y" : 120.652944 },
			{ "x" : 24.134889, "y" : 120.651316 },
			{ "x" : 24.134817, "y" : 120.649872 },
			{ "x" : 24.134776, "y" : 120.648293 },
			{ "x" : 24.134742, "y" : 120.647198 },
			{ "x" : 24.134691, "y" : 120.646470 },
			{ "x" : 24.134683, "y" : 120.646311 },
			{ "x" : 24.134692, "y" : 120.645576 },
			{ "x" : 24.134727, "y" : 120.644566 },
			{ "x" : 24.134747, "y" : 120.643869 },
			{ "x" : 24.134796, "y" : 120.642957 },
			{ "x" : 24.134822, "y" : 120.642528 },
			{ "x" : 24.134861, "y" : 120.641331 },
			{ "x" : 24.135194, "y" : 120.638620 },
			{ "x" : 24.135312, "y" : 120.638174 },
			{ "x" : 24.135767, "y" : 120.636682 },
			{ "x" : 24.135949, "y" : 120.635977 },
			{ "x" : 24.136091, "y" : 120.635430 },
			{ "x" : 24.136255, "y" : 120.634834 },
			{ "x" : 24.136411, "y" : 120.634321 },
			{ "x" : 24.136781, "y" : 120.633724 },
			{ "x" : 24.137555, "y" : 120.632619 },
			{ "x" : 24.138499, "y" : 120.631228 },
			{ "x" : 24.138747, "y" : 120.630851 },
			{ "x" : 24.138964, "y" : 120.630569 },
			{ "x" : 24.140159, "y" : 120.628556 },
			{ "x" : 24.140223, "y" : 120.628152 },
			{ "x" : 24.140527, "y" : 120.625905 },
			{ "x" : 24.140550, "y" : 120.625700 },
			{ "x" : 24.140697, "y" : 120.624811 },
			{ "x" : 24.140784, "y" : 120.623967 },
			{ "x" : 24.140520, "y" : 120.623105 },
			{ "x" : 24.140423, "y" : 120.622748 },
			{ "x" : 24.140394, "y" : 120.622532 },
			{ "x" : 24.140278, "y" : 120.622177 },
			{ "x" : 24.139981, "y" : 120.620730 },
			{ "x" : 24.139612, "y" : 120.618017 },
			{ "x" : 24.139585, "y" : 120.617819 },
			{ "x" : 24.139143, "y" : 120.614264 },
			{ "x" : 24.139069, "y" : 120.613853 },
			{ "x" : 24.138924, "y" : 120.613413 },
			{ "x" : 24.138770, "y" : 120.613061 },
			{ "x" : 24.138445, "y" : 120.612469 },
			{ "x" : 24.138470, "y" : 120.611480 },
			{ "x" : 24.138446, "y" : 120.610852 },
			{ "x" : 24.138443, "y" : 120.610364 },
			{ "x" : 24.138455, "y" : 120.610058 },
			{ "x" : 24.138473, "y" : 120.609631 },
			{ "x" : 24.138471, "y" : 120.609483 },
			{ "x" : 24.138525, "y" : 120.608423 },
			{ "x" : 24.138527, "y" : 120.608209 },
			{ "x" : 24.138616, "y" : 120.607042 },
			{ "x" : 24.138720, "y" : 120.606550 },
			{ "x" : 24.138993, "y" : 120.605692 },
			{ "x" : 24.139315, "y" : 120.601667 },
			{ "x" : 24.139438, "y" : 120.599609 },
			{ "x" : 24.139463, "y" : 120.599439 },
			{ "x" : 24.140145, "y" : 120.595480 },
			{ "x" : 24.139850, "y" : 120.595160 },
			{ "x" : 24.139342, "y" : 120.595147 },
			{ "x" : 24.139324, "y" : 120.594662 },
			{ "x" : 24.139319, "y" : 120.594180 },
			{ "x" : 24.139290, "y" : 120.593817 },
			{ "x" : 24.139279, "y" : 120.593438 },
			{ "x" : 24.139250, "y" : 120.592903 },
			{ "x" : 24.139225, "y" : 120.592330 },
			{ "x" : 24.139204, "y" : 120.591799 },
			{ "x" : 24.139092, "y" : 120.588296 },
			{ "x" : 24.138891, "y" : 120.585526 },
			{ "x" : 24.138072, "y" : 120.586483 },
			{ "x" : 24.129435, "y" : 120.588587 }
		];

		var count = 0;


		function setResult() {
			if (count < test.length - 1 ) {
				console.log('count:' + count + '\thttps://maps.googleapis.com/maps/api/distancematrix/json?mode=driving&origins=' + 
					test[count].x + ',' + test[count].y + '&destinations=' + test[count+1].x + ',' + test[count+1].y + '&key=AIzaSyBjhFib1SV0nsoB_uYHlqKe-R5_goyjTn0');
				// console.log('count:' + count + '\ttest1-x:' + test[count].x + '\ttest1-y:' + test[count].y + '\ttest2-x:' + test[count+1].x + '\ttest2-y:' + test[count+1].y);
				getDistance2(test[count].x, test[count].y, test[count+1].x, test[count+1].y);
			}

			count++;
		}

		// test.forEach(function (value, key) {

		// 	// if (key != test.length - 1) {
		// 	if (count <= 10) {
		// 		getDistance2(value.x, value.y, test[key+1].x, test[key+1].y);
		// 	}

		// 	count++;

		// 	test.forEach(function (value2, key2) {

		// 		if (count >= 21)
		// 			return;
		// 		count++;

		// 		if (key1 != key2) {
		// 			getDistance2(value1.x, value1.y, value2.x, value2.y);
		// 			//console.log('value1-x:' + value1.x + '\tvalue1-y:' + value1.y + '\tvalue2-x:' + value2.x + '\tvalue2-y:' + value2.y);
		// 		}

		// 	});
		// });
		
	</script>

</body>
</html>